{"id":"mpy-1","title":"Bytecode migration (MicroPython-style)","description":"Migrate MoonPython execution from AST-walking interpreter to bytecode compiler + bytecode VM (MicroPython-inspired), keeping legacy fallback until parity.","status":"done","priority":2,"issue_type":"epic","owner":"842376130@qq.com","created_at":"2026-01-28T10:34:41.789003+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:31:43.60058+08:00"}
{"id":"mpy-1.1","title":"Unify comparison semantics (AST vs bytecode)","description":"Extract comparison logic from runtime_eval_expr into shared helpers and make bytecode VM delegate to it. This avoids semantic divergence (NotImplemented, strict subclass, __contains__/iteration, set comparisons, etc.).","acceptance_criteria":"- No duplicated comparison logic in bytecode_vm.mbt\\n- runtime_eval_expr.mbt uses shared helper\\n- Existing tests still pass","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T10:35:00.287942+08:00","created_by":"Milky2018","updated_at":"2026-01-28T10:53:59.273736+08:00","dependencies":[{"issue_id":"mpy-1.1","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.2","title":"Compile Stmt::Function (def) to bytecode","description":"Support compiling function definitions to bytecode, including creating FunctionValue, defaults evaluation, local/global/nonlocal declarations, and executing function bodies via bytecode.","acceptance_criteria":"- Modules with def do not force AST fallback\\n- Existing function tests pass","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T10:35:00.347262+08:00","created_by":"Milky2018","updated_at":"2026-01-28T11:05:56.573518+08:00","dependencies":[{"issue_id":"mpy-1.2","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.3","title":"Support chained comparisons in bytecode","description":"Compile and execute chained comparisons (a \u003c b \u003c c) with correct short-circuiting and single evaluation of middle operands.","acceptance_criteria":"- Matches AST interpreter behavior for chained comparisons","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T10:35:00.406646+08:00","created_by":"Milky2018","updated_at":"2026-01-28T11:10:14.172701+08:00","dependencies":[{"issue_id":"mpy-1.3","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.3","depends_on_id":"mpy-1.1","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.4","title":"Bytecode try/except/finally","description":"Introduce VM block stack and opcodes needed for try/except/finally; compile Try stmt and run stdlib tests that rely on exception flow.","acceptance_criteria":"- try/except/finally tests pass","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T10:35:00.463265+08:00","created_by":"Milky2018","updated_at":"2026-01-28T11:42:22.943423+08:00","dependencies":[{"issue_id":"mpy-1.4","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.5","title":"Bytecode with/async with","description":"Compile With/AsyncWith and execute via VM using __enter__/__exit__ and exception handling integration.","acceptance_criteria":"- with_test.mbt passes on bytecode path","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T10:35:00.52272+08:00","created_by":"Milky2018","updated_at":"2026-01-28T12:45:09.478719+08:00","dependencies":[{"issue_id":"mpy-1.5","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.5","depends_on_id":"mpy-1.4","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.6","title":"Bytecode return unwinding for (async) with","description":"Ensure return inside with/async with runs __exit__/__aexit__ before returning (compiler-managed cleanup stack).","acceptance_criteria":"- Add tests for return inside with and async with\\n- Delete compiler-internal __mpy_with_exit names before leaving with\\n- moon check passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T12:49:36.637964+08:00","created_by":"Milky2018","updated_at":"2026-01-28T13:03:54.656715+08:00","dependencies":[{"issue_id":"mpy-1.6","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.6","depends_on_id":"mpy-1.4","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.6","depends_on_id":"mpy-1.5","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.7","title":"Compiler unwind chain for return across try/finally + (async) with","description":"Replace ad-hoc return cleanup logic with a structured compiler-generated unwind chain so nested try/finally and (async) with run cleanup in correct order (finally vs __exit__), including cases like with(outside) + try/finally(inside).","acceptance_criteria":"- Add regression test: with outside try/finally return runs finally before __exit__\\n- Existing with/async with return tests still pass\\n- moon check passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T13:13:50.573794+08:00","created_by":"Milky2018","updated_at":"2026-01-28T13:34:59.005105+08:00","dependencies":[{"issue_id":"mpy-1.7","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.7","depends_on_id":"mpy-1.5","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.7","depends_on_id":"mpy-1.4","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-1.8","title":"UnwindJump for break/continue across finally/with","description":"Add MicroPython-style UNWIND_JUMP to the bytecode VM and compiler so break/continue crossing try/finally and with/async with executes cleanup in correct order.","acceptance_criteria":"- break/continue inside try/finally triggers finally\\n- break/continue inside with/async with triggers __exit__/__aexit__\\n- moon check passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T13:36:42.45686+08:00","created_by":"Milky2018","updated_at":"2026-01-28T13:45:33.073825+08:00","dependencies":[{"issue_id":"mpy-1.8","depends_on_id":"mpy-1","type":"parent-child","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"mpy-1.8","depends_on_id":"mpy-1.7","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-2","title":"Bytecode coverage expansion","description":"Expand the MicroPython-style bytecode compiler/VM to cover more AST constructs so we can rely less on the legacy AST evaluator (eventually enabling bytecode-only mode for supported subsets).","acceptance_criteria":"- Reduce compiler NotImplemented fallbacks on existing tests\n- moon check passes\n- moon test passes","status":"open","priority":2,"issue_type":"epic","owner":"842376130@qq.com","created_at":"2026-01-28T14:32:33.24003+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:32:33.24003+08:00"}
{"id":"mpy-2.1","title":"Bytecode: while-else","description":"Implement while-else compilation in bytecode_compiler.mbt using existing loop context (similar to for-else).","acceptance_criteria":"- e2e/while_else_and_for_else still passes; - moon check passes; - moon test passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T14:33:17.161908+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:45:55.08673+08:00","dependencies":[{"issue_id":"mpy-2.1","depends_on_id":"mpy-2","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-2.2","title":"Builtin: reversed() supports len","description":"Fix builtin reversed() so that len(reversed(seq)) works (at least for built-in sequences) and matches existing e2e expectations.","acceptance_criteria":"- e2e/builtin_reversed passes; - moon check passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T14:46:32.74452+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:47:20.383924+08:00","dependencies":[{"issue_id":"mpy-2.2","depends_on_id":"mpy-2","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-2.3","title":"Test: range() step 0 raises ValueError","description":"Align range() step=0 error type with CPython (ValueError) and update e2e expectation accordingly.","acceptance_criteria":"- e2e/builtin_range passes","status":"done","priority":3,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T14:47:50.745073+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:48:20.80425+08:00","dependencies":[{"issue_id":"mpy-2.3","depends_on_id":"mpy-2","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"mpy-2.4","title":"Builtin: super() zero-arg","description":"Implement zero-argument super() inside methods by inferring (type, self/cls) from the current function frame / closure, enough to satisfy e2e/builtin_super_zero_arg and future stdlib usage.","acceptance_criteria":"- e2e/builtin_super_zero_arg passes; - moon check passes","status":"done","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T14:48:37.541564+08:00","created_by":"Milky2018","updated_at":"2026-01-28T14:54:23.230489+08:00","dependencies":[{"issue_id":"mpy-2.4","depends_on_id":"mpy-2","type":"parent-child","created_at":"0001-01-01T00:00:00Z"}]}
